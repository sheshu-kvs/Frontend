<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Forms With The Crud</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        background-color: #6fa4af;
        font-family: cursive;
      }
      form {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 90vh;
      }
      table {
        padding: 2rem;
        background-color: #b8c4a9;
        border-radius: 1rem;
      }
      input {
        padding: 10px;
        margin-bottom: 3px;
        border: none;
        outline: none;
        font-size: 1rem;
        border-bottom: 2px solid black;
        border-radius: 1rem;
      }
      .btn {
        cursor: pointer;
        font-size: 1rem;
        padding: 1px;
        border: none;
        border-bottom: 2px solid black;
        border-radius: 8px;
        margin-top: 3px;
        margin-bottom: 3px;
        outline: none;
      }

      #user-list {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
      }
      .usersdiv {
        padding: 10px;
        width: 300px;
        border: none;
        border-radius: 15px;
        background-color: #b4debd;
      }
      /* input:hover {
        border-bottom: 10px solid #d9755;
      } */

      /* @media (max-width: 600px) {
    table {
      width: 100%;
      padding: 0.5rem;
    }
    td {
      display: block;
      width: 100%;
    }
    td input, .btn {
      width: 100%;
      box-sizing: border-box;
    }
  } */
    </style>
  </head>
  <body>
    <!-- <h2 id="dispmessage"></h2> -->
    <form action="">
       <!-- <h2 id="dispmessage"></h2> -->
      <table>
       <!--  <h2 id="dispmessage"></h2> -->
        <tr>
          <td>Name</td>
          <td>
            <input
              type="text"
              placeholder="Enter the Name"
              id="name"
              required
            />
          </td>
        </tr>
        <tr>
          <td>Email</td>
          <td>
            <input
              type="email"
              placeholder="Enter the Email"
              id="email"
              required
            />
          </td>
        </tr>
        <tr>
          <td>Phone Number</td>
          <td>
            <input
              type="number"
              placeholder="Enter the Phone Number"
              id="phonenumber"
              required
            />
          </td>
        </tr>
        <tr>
          <td>Address</td>
          <td>
            <input
              type="text"
              placeholder="Enter the Address"
              id="address"
              required
            />
          </td>
        </tr>
        <tr>
          <td colspan="2" style="text-align: center">
            <button id="btn" class="btn" type="button">Submit</button>
            <button id="reg" class="btn" type="button">ShowAllUsers</button>
            <button id="get" class="btn" type="button">GetOneUser</button>
            <button id="del" class="btn" type="button">DeleteOneUser</button
            ><br />
            <label for="" id="src-label" style="display: none"
              >Enter the Name</label
            >
            <input
              type="text"
              id="srcname"
              style="display: none; padding: 10px"
            />
            <!-- <button id="get">get</button> -->
          </td>
        </tr>
      </table>
    </form>
    <div id="para">
      <!-- <h2>All Registered Users</h2> -->
      <div id="Addeduser"></div>
      <div id="user-list"></div>
    </div>
    <div id="getoneuser"></div>

    <div id="deleteoneuser"></div>

    <script>
      let button12 = document.querySelector("#btn");
      let register = document.querySelector("#reg");
      let name = document.querySelector("#name");
      let email = document.querySelector("#email");
      let phonenumber = document.querySelector("#phonenumber");
      let address = document.querySelector("#address");

      const a = JSON.parse(localStorage.getItem("users")) || [
        //  it does the two things  like the when
        //it gets the data from the local storage which means existing user details
        // if no data is present in the local storage by default in the array stored object
        // it will display this data
        // localStorage.setItem("users", JSON.stringify(a))
        // Save your array of users in the browser, so it wonâ€™t disappear on refresh.

        // JSON.stringify : converts array/object to string (required for storage).

        // JSON.parse : converts the string back to usable array/object.
        {
          name: "Alice",
          email: "alice@example.com",
          phonenumber: "7204375248",
          address: "Cannada",
        },
        {
          name: "Bob",
          email: "bob@example.com",
          phonenumber: "9008532514",
          address: "Australia",
        },
        {
          name: "Jaya",
          email: "jaya@gmail.com",
          phonenumber: "7204375248",
          address: "Banglore",
        },
      ];

      let body = document.body;

      let addeduser = document.querySelector("#Addeduser");

      function addUser() {
        // let userdiv = document.querySelector("#user-list");
        let deletedbtn = document.querySelector("#deleteoneuser");
        let oneuser = document.querySelector("#getoneuser");
        let addeduser = document.querySelector("#Addeduser");
        let message=document.querySelector("#dispmessage");
        deletedbtn.innerHTML = "";
        oneuser.innerHTML = "";
        // userdiv.innerHTML = "";
        addeduser.innerHTML = "";




        // checking the validations like the 

        let Username=name.value;
        let Useremail = email.value;
        let Userphonenumber = phonenumber.value;
        let Useraddress=address.value;


        //validating the fields if the fields are the empty
        if(!Username || !Useremail || !Userphonenumber || !Useraddress){
          addeduser.innerHTML=`<p style=color:black;">Please Fill the Fields</p>`;
          return;
        }
        // if(Use)


        if(Userphonenumber>11){
          addeduser.innerHTML=`<p style="color:black;">Please Enter the 10 Digits Phone Number`;
            return;
        }
        else{
          let user = {
          name: name.value,
          email: email.value,
          phonenumber: phonenumber.value,
          address: address.value,
        };

        a.push(user);
        localStorage.setItem("users", JSON.stringify(a)); // Saves the  new data in the local storage
        RegisteredUsers([user]); //it will display only the newly added user details [new user object]

        // addeduser.innerHTML=`
        // Successfuly Added the User ${user.name}`;

        name.value = "";
        email.value = "";
        phonenumber.value = "";
        address.value = "";
        }





        // let user = {
        //   name: name.value,
        //   email: email.value,
        //   phonenumber: phonenumber.value,
        //   address: address.value,
        // };

        // a.push(user);
        // localStorage.setItem("users", JSON.stringify(a)); // Saves the  new data in the local storage
        // RegisteredUsers([user]); //it will display only the newly added user details [new user object]

        // // addeduser.innerHTML=`
        // // Successfuly Added the User ${user.name}`;

        // name.value = "";
        // email.value = "";
        // phonenumber.value = "";
        // address.value = "";
      }

      button12.addEventListener("click", (e) => {
        e.preventDefault();
        addUser();
      });

      function RegisteredUsers(users) {
        let userdiv = document.querySelector("#user-list");
        let divtagmessage = document.querySelector("#deleteoneuser");
        divtagmessage.innerHTML = "";
        userdiv.innerHTML = "";
        users.forEach((user) => {
          let newdiv = document.createElement("div");
          newdiv.className = "usersdiv";
          newdiv.innerHTML = `
               <p><b>Name :</b>  ${user.name}</p>
               <p><b>Email :</b> ${user.email}</p>
               <p><b>Phone Number :</b> ${user.phonenumber}</p>
               <p><b>Address :</b> ${user.address}</p>
                <button id="edbtn">Edit</button>
                <button id="delebtn">Delete</button>`;

          userdiv.appendChild(newdiv);
        });
      }

        register.addEventListener("click", (e) => {
        e.preventDefault();
        document.querySelector("#getoneuser").innerHTML = "";
        localStorage.setItem("users", JSON.stringify(a)); //converts the array objects to the json strings
        window.location.href = "AllUsers.html";
        // RegisteredUsers(a);
      });

      function getOneUser() {
        let searchName = document
          .querySelector("#srcname")
          .value.trim()
          .toLowerCase();
        //validating no user in the field

        if(!searchName){
          addeduser.innerHTML=`<p style = "color:black">Please Enter the Name </p>`
          return;
        }

        let oneuser = document.querySelector("#getoneuser");
        let deleteuser = document.querySelector("#deleteoneuser");
        let userdiv = document.querySelector("#user-list");

        userdiv.innerHTML = "";
        oneuser.innerHTML = "";
        deleteuser.innerHTML = "";

        // another method to find the values in the array we use the find
        let foundUser = a.find((user) => user.name.toLowerCase() == searchName);

        if (foundUser) {
          oneuser.innerText = `User Was Found ${searchName}`;
        } else {
          oneuser.innerText = `User Was Not Found ${searchName}`;
        }

        //   for (let val of a) {
        //     if (val.name === searchName) {
        //       oneuser.textContent = `Search Name Was Found ${searchName}`;
        //       return;
        //     }
        //   }
        //   oneuser.textContent = `Search Name Was Not Found ${searchName}`;
      }

      get.addEventListener("click", (e) => {
        e.preventDefault();
        document.querySelector("#src-label").style.display = "inline-block";
        document.querySelector("#srcname").style.display = "inline-block";
        getOneUser();
      });

      function deleteOneUser() {
        let deleteduser = document.querySelector("#srcname").value;
        // valdating if the filed is empty 
        if(!deleteduser){
          addeduser.innerHTML=`<p style="color:black">Please Enter the Name `
            return;
        }
        let divtagmessage = document.querySelector("#deleteoneuser");
        let userdiv = document.querySelector("#user-list");
        document.querySelector("#getoneuser").innerHTML = "";
        userdiv.innerHTML = "";
        divtagmessage.innerHTML = "";
        let flag = false;
        for (let i = 0; i < a.length; i++) {
          if (a[i].name === deleteduser) {
            a.splice(i, 1);
            divtagmessage.innerText = `UserName Was Sucessfully Deleted ${deleteduser}`;
            flag = true;
            break;
          }
        }

        if (!flag) {
          divtagmessage.innerText = `UserName Not Found ${deleteduser}`;
        }

        //  const originallength=a.length;
        //  updatedUser=a.filter( user => user.name !== deleteduser);
        //   console.log(updatedUser);
        //   a.length = 0;
        //  a.push(...updatedUser);

        //   const modifiedlength=a.length;
        //   if(updatedUser.length<originallength){
        //       divtagmessage.textContent =`Entered Username Was Successfully Deleted ${deleteduser}`;
        //   }
        //   else{
        //        divtagmessage.textContent =`Entered Username Was not Found ${deleteduser}`;
        //   }
      }

        del.addEventListener("click", (e) => {
        e.preventDefault();
        document.querySelector("#src-label").style.display="inline-block";
        document.querySelector("#srcname").style.display="inline-block";
        deleteOneUser();
      });
    </script>
  </body>
</html>
